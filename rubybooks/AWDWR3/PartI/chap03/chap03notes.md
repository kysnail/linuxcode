# Chapter 3 - Installing Rails

## Your Shopping List
为了让 Rails 跑起来，你需要下列东西：

 * 一个 Ruby 解释器。
 * Ruby On Rails。
 * 一些必要的库。
 * 数据库

如果要部署应用程序，就（至少）还需要安装一个生产 web 服务器，以及一些能够提升 Rails 运行效率的支持代码。

## Installing on Linux
不同的 Linux 发行版会使用不同的包管理系统，但总的来说安装起来都很方便。

 * aptitude 
 * dpkg
 * portage
 * rpm
 * rug
 * synaptic
 * up2date
 * yum

我这里 Debian 进行的测试，过程还是比较简单，只需要在过程中更换一个国内的 ruby 源即可。

    $ apt-get install build-essential libopenssl-ruby
    $ apt-get install ruby rubygems
  
接下来就可以使用 Rails 的 gem 管理系统安装 rails 以及 sqlite 驱动。

    $ gem install rails
    $ gem install sqlite3-ruby

最后将 `/var/lib/gems/1.8/bin` 加入到 PATH 环境变量中。

    vim ~/.bashrc
    export PATH=/var/lib/gems/1.8/bin:$PATH

## Development Environments

### The Command Line
这里提到了一 Windows 操作系统中的小工具

    TwakUI

值得尝试一下。

### Version Control
我们把所有工作都放在版本控制系统傻瓜——现在用的是 Git。创建一个新的 Rails 项目，我们就会立即把它签入 Git；
每当所有的测试通过时，我们就会把修改过的文件全部签入。一般而言，我们会每小时多次签入代码。

如果项目有多人一起开发，可以考虑搭建一个持续集成（continuous integration, CI）系统：每当有人签入任何修改过的文件时，CI 系统就会签出整个应用程序，然后运行所有测试，这是一种简单的保证意外的破坏能够马上被注意到的方法。此外，CI 系统让客户也可以随时使用应用程序的最新版本。CI 可以大大增加项目的透明度，以确保项目没有偏离正轨。

### Editors
程序员们常用的编辑器都可以用来编写 Ruby 程序。这些年来我发现，不同的编辑器适用于不同的语言和环境。譬如说，Dave 原来写着一章的内容是用 Emacs 写的，他感觉 Emacs 的 Filladadpt 模式非常方便：

    当输入文字时，它会巧妙地格式化 XML。

Sam 是用 VIM 来修改。也有很多人觉得 Emacs 和 VIM 都不够理想，他们更喜欢用 TextMate 。虽说选择编辑器是一件个人色彩浓重的事情，不过当你寻找合适的 Rails 编辑器时，还是有一些建议可以给你的。

 * 支持 Ruby 和 HTML 的语法高亮，最好是支持 `.erb` 文件（这是 Rails 使用的一种文件格式，在 HTML 中嵌入了 Ruby 片段）。
 * 支持 Ruby 源代码的自动缩进和格式重排。
 * 支持常用 Ruby 和 Rails 语法结构的插入。
 * 良好的文件浏览支持。

    一个创建的 Rails 应用包含 48 个文件，它们分布在 37 个目录中，而这时你还什么都没写呢....

 * 名称补全。

### The Desktop
I'm not going to tell you how to organize your desktop while working with Rails, but I will describe what I do.

Most of the time. I'm writing code, running tests, and poking at my application in a browser. So my main development desktop has an editor window and a browser window permanently open. I also want to keep an eye on the logging that's generated by my application, so I keep a teminal window open. In it I use `tail -f` to scroll the contents of the log file as it's updated. I normally run this window with a very small font so it takes up less space - if I see something interesting flash by, I zoom it up to investigate.

I also need access to the Rails API documentation, which I view in a browser. In the introduction we talked about using the `gem server` (For release of rubygems prior to 0.9.5, use the command `gem_server`) command to run a local web server containing the Rails documentation. This is convenient, but it unfortunately splits the Rails documentation across a number of separate documentation trees. If you're online, you can use http://api.rubyonrails.org to see a consolidated view of all the Rails documentation in one place.

## Rails and Databases
数据库驱动都是用 C 编写的，并且多以源码形式发布。如果你不想费劲编译源码得到驱动程序，就请认真查看驱动的网站，很多时候作者也会同时发布编译好的二进制版本。

    数据库密码
    ----------
    这里有一点颇具有争议的提示。生产数据库总是要设置密码的，但大部分 Rails 开发者似乎并不想费心给开发
    数据库设置密码，对于 SQLite3 来说这并没有争议，但是对于象 MySQL 这样的数据库来说是有争议的，尤其是
    懒到在开发中直接使用 MySQL 默认的 root 用户。这样有危险吗？有人却是这样认为，但一般来说开发机器都
    位于（至少理应位于）防火墙后面，而且 MySQL 还允许你设置 skip_networking 选项来禁止远程访问。所以，
    如果你一直跟着我们的步伐，就应该使用一个没有密码的 root 用户；如果你创建了别的用户或者设置了别的密码，
    就需要调整连接参数和命令行输入的命令（假如你设置了密码，就需要在连接 MySQL 时加上 p 选项）。至于“如何
    部署安全的 MySQL 生产环境”，请看 SecurityFocus 上的一篇文章 —— “Securing MySQL: Step-by-Step”
    (http://www.securityfocus.com/infocus/1726)

有用纯 Java 语言编写的 JDBC 驱动，同样也有用 Ruby 语言编写的数据库驱动，比如下面的 PostgreSQL 驱动：

    Ruby-DBI
    http://rubyforge.org/projects/ruby-obi

MySQL 与 SQLite 的驱动都可以通过 RubyGems 下载（gem 名称分别是 mysql 和 sqlite3-ruby）。

## Keeping Up-to-Date
如果你是通过 RubyGems 安装的 Rails，保持更新就非常简单，只要输入下列命令：

    rubys> gem update rails

RubyGems 就会自动更新你的 Rails 安装版本（**gems 的早期版本需要 --include-dependencies 选项。**）。RubyGems 会自动保存升级之前的旧版本文件，用下列命令就可以删除这些备份文件。

    rubys> gem cleanup

安装了最新版本的 Rails 之后，你可能希望同时更新 Rails 在创建应用程序之初加入其中的那些文件（例如用于支持 Ajax 的 JavaScript 库、各种脚本等等）。只要在**应用程序的顶级目录**运行下列目录即可：

    rubys> rake rails:update

## Rails and ISPs
如果你希望 Rails 应用程序放在共享主机环境下，使人们可以通过 Internet 访问它就需要寻找一家支持 Ruby 的 ISP —— 它必须支持 Ruby，拥有你需要的 Ruby 数据库驱动并且提供 Phusion Passenger 和 / 或 Mongrel 代理设置。


