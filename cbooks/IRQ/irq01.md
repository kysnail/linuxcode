## 中断号是什么？

### 一、什么是 IRQ？
IRQ 的全称是 `Interupt ReQuest`，即 “中断请求”。当电脑内的周边硬件需要处理器去执行某些工作时，该硬件就会发出一个硬件信号，通知处理器工作，而这个信号就是IRQ。

那为什么叫做“中断”呢？“中断”的意思是即使处理器正在执行其他工作，当它收到周边设备传来的中断信号时，处理器也会停下来，优先处理这个信号代表的工作，完成后再继续处理之前未完成的工作。

### 二、什么是 IRQ 冲突？
IRQ的数目有限，一部电脑虽然一共有16个IRQ（从IRQ0至IRQ15），但是其中很多IRQ已经预先分配给特定的硬件，具体如下： 

 * IRQ0：系统计时器 
 * IRQ1：键盘 
 * IRQ2：可设置中断控制卡 
 * IRQ3：COM2（串行接口2） 
 * IRQ4：COM1（串行接口1） 
 * IRQ5：未预先配置 
 * IRQ6：磁盘机 
 * IRQ7：并行接口 
 * IRQ8：CMOS/时钟 
 * IRQ9：未预先配置 
 * IRQ10：未预先配置 
 * IRQ11：未预先配置 
 * IRQ12：PS/2鼠标 
 * IRQ13：算术处理器（Arithmetic Processor） 
 * IRQ14：Primary（主）IDE控制器 
 * IRQ15：Secondary（从）IDE控制器 

由上可见，IRQ5、IRQ9、IRQ10和IRQ11都是空置的。但大家不要以为这就代表着有多余的IRQ可以使用。因为要使用IRQ的周边设备实在是太多了，例如声卡、网卡等PCI或ISA设备都需要配置一个IRQ。如果有两个设备配置了同一个IRQ的话，就会出现IRQ冲突的问题，从而使两者都不能正常工作。 

### 三、遇到 IRQ 冲突怎么办？
大家可能会问，一般主板都有四根或更多PCI插槽。如果全都插上PCI扩展卡，那四个空置的IRQ又怎么够用呢？ 

其实，某些硬件是可以共用一个IRQ的，而有些却又偏偏不行。例如PCI声卡需要独自享用一个IRQ，有时甚至需要两个，一个作MIDI（迷笛），一个作Wave（波表）。因此当系统自动分配IRQ时，若声卡被分配与其他设备共用一个IRQ的话，发生IRQ冲突的可能性极大，而解决之道就是手动分配IRQ，在BIOS内进行设置。 

### 四、实例示范
假设一块主板上有五根PCI插槽，现在五根插槽全部插满了（包括MODEM卡、网卡、声卡、电视卡等等）。但无论将声卡插在任何一根PCI插槽内，都无法正常工作。解决步骤如下： 

1、查看主板说明书，找出哪一根PCI插槽是不与其他插槽共用IRQ的（一般是第三根插槽），然后将声卡插到第三根PCI插槽中。同时，由于第一和第五根PCI插槽需共用IRQ，我们还应检查插在上面的硬件设备及其驱动程序是否支持共用IRQ。 

2、启动电脑，进入BIOS，开启“Advanced”一栏最底下的“PCI Configuration”。 

3、在“PCI Configuration”设置页面的上半部分有一项“Slot 3 
IRQ”，它就是第三根PCI插槽所分配的IRQ位置。系统默认为“Auto”（自动）。 

4、将光标移到“Slot 3 
IRQ”一行上按回车键，画面会显示“0-15”的数字。这时用户可选择四个空闲中断（IRQ5、IRQ9、IRQ10或IRQ11）的任一个，这里笔者选择“IRQ10”。 

5、再为其他的Slot插槽设置其他的IRQ。例如Slot 1/5的IRQ设置成“IRQ3”、Slot 2 IRQ设置为“IRQ9”，Slot 
4设置为“IRQ11”等。 

6、此外，如果你使用的主板集成有老一代的ISA插槽的话，还要在“PCI IRQ Resource 
Exclusion”选项中，对个别的ISA总线硬件所需的IRQ进行更改设置。 

7、完成设置后选择保存设置并重新启动电脑，就可以向烦人的IRQ冲突说BYEBYE啦。 

### 五、结束语 
正如本文开头所述，IRQ设置对一般人而言是有点难度。但随着专门为解决中断及I/O接口冲突问题而设计的“即插即用”（Plug and 
Play）硬件的问世，再配合如Windows一样支持PnP的操作系统，已经大大减少了IRQ冲突发生的可能性。 

基本上，现在除了声卡有可能出现IRQ冲突的问题外，其他电脑硬件一般都不会出现这种问题。不过，既然只需简单的几步设置就能够解决问题，多学一点总不是坏事吧！

### 六、Linux 查看在用的 irq

    # cat /proc/interrupts

**Refs**

 * [中断号是什么](http://hi.baidu.com/jaimy_jie/item/edca20d26f422be5b3f777f4)
